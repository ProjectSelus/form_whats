<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Resumo de Servi√ßo</title>
    <!-- Carrega o Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilo para a fonte Inter */
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Adiciona um estilo para os inputs num√©ricos n√£o terem setas (opcional, mas limpo) */
        input[type='number']::-webkit-inner-spin-button,
        input[type='number']::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type='number'] {
            -moz-appearance: textfield;
        }
    </style>
    <!-- Importa a fonte Inter do Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body class="bg-gray-100 text-gray-900 p-4 md:p-8">

    <div class="max-w-4xl mx-auto bg-white p-6 md:p-8 rounded-lg shadow-md">

        <!-- Cabe√ßalho com T√≠tulo Din√¢mico -->
        <div class="mb-6 text-center">
            <h1 id="titulo-relatorio" class="text-2xl md:text-3xl font-bold text-blue-700">
                Carregando t√≠tulo...
            </h1>
        </div>

        <!-- Formul√°rio Principal -->
        <form id="report-form" class="space-y-6">

            <!-- Se√ß√£o 1: Sele√ß√£o OPM e Viaturas -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 p-4 border border-gray-200 rounded-lg">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">OPM (Obrigat√≥rio)</label>
                    <!-- Substitu√≠do o <select> por bot√µes de r√°dio estilizados -->
                    <div id="opm-radio-group" class="grid grid-cols-2 sm:grid-cols-4 gap-2 mt-2">
                        <div>
                            <input type="radio" id="opm-sede" name="opm" value="Sede" class="sr-only peer" required>
                            <label for="opm-sede"
                                class="block w-full p-2 text-center border border-gray-300 rounded-md cursor-pointer peer-checked:bg-blue-600 peer-checked:text-white peer-checked:border-blue-600 hover:bg-gray-50 transition-colors">
                                Sede
                            </label>
                        </div>
                        <div>
                            <input type="radio" id="opm-iguatemi" name="opm" value="2¬∞ PEL Iguatemi" class="sr-only peer">
                            <label for="opm-iguatemi"
                                class="block w-full p-2 text-center border border-gray-300 rounded-md cursor-pointer peer-checked:bg-blue-600 peer-checked:text-white peer-checked:border-blue-600 hover:bg-gray-50 transition-colors">
                                Iguatemi
                            </label>
                        </div>
                        <div>
                            <input type="radio" id="opm-japora" name="opm" value="3¬∞ PEL Japor√£" class="sr-only peer">
                            <label for="opm-japora"
                                class="block w-full p-2 text-center border border-gray-300 rounded-md cursor-pointer peer-checked:bg-blue-600 peer-checked:text-white peer-checked:border-blue-600 hover:bg-gray-50 transition-colors">
                                Japor√£
                            </label>
                        </div>
                        <div>
                            <input type="radio" id="opm-eldorado" name="opm" value="4¬∞PEL Eldorado" class="sr-only peer">
                            <label for="opm-eldorado"
                                class="block w-full p-2 text-center border border-gray-300 rounded-md cursor-pointer peer-checked:bg-blue-600 peer-checked:text-white peer-checked:border-blue-600 hover:bg-gray-50 transition-colors">
                                Eldorado
                            </label>
                        </div>
                    </div>
                </div>
                <div>
                    <label for="viaturas" class="block text-sm font-medium text-gray-700 mb-1">Viaturas Empregadas
                        (Obrigat√≥rio)</label>
                    <select id="viaturas" name="viaturas" required
                        class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        <option value="1" selected>1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                    </select>
                </div>
            </div>

            <!-- Se√ß√£o 2: Entradas Num√©ricas -->
            <div class="p-4 border border-gray-200 rounded-lg">
                <h2 class="text-lg font-semibold text-gray-800 mb-4">Estat√≠sticas</h2>
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
                    <!-- Lista de campos num√©ricos -->
                    <div class="form-group">
                        <label for="veiculos-abordados"
                            class="block text-sm font-medium text-gray-700">Ve√≠culos abordados</label>
                        <input type="number" id="veiculos-abordados" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group">
                        <label for="pessoas-abordadas"
                            class="block text-sm font-medium text-gray-700">Pessoas abordadas</label>
                        <input type="number" id="pessoas-abordadas" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group">
                        <label for="aits" class="block text-sm font-medium text-gray-700">AITs</label>
                        <input type="number" id="aits" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group">
                        <label for="sinistros" class="block text-sm font-medium text-gray-700">Sinistros
                            Atendidos</label>
                        <input type="number" id="sinistros" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group">
                        <label for="veiculos-apreendidos-crime"
                            class="block text-sm font-medium text-gray-700">Ve√≠culos Apreendidos (crime)</label>
                        <input type="number" id="veiculos-apreendidos-crime" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group">
                        <label for="veiculos-apreendidos-fisc"
                            class="block text-sm font-medium text-gray-700">Ve√≠culos Apreendidos (fisc.)</label>
                        <input type="number" id="veiculos-apreendidos-fisc" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group">
                        <label for="veiculos-recuperados"
                            class="block text-sm font-medium text-gray-700">Ve√≠culos Recuperados</label>
                        <input type="number" id="veiculos-recuperados" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group">
                        <label for="armas-apreendidas" class="block text-sm font-medium text-gray-700">Armas de fogo
                            apreendidas</label>
                        <input type="number" id="armas-apreendidas" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group">
                        <label for="pessoas-dpc" class="block text-sm font-medium text-gray-700">Pessoas
                            encaminhadas a DPC</label>
                        <input type="number" id="pessoas-dpc" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group">
                        <label for="menores-apreendidos"
                            class="block text-sm font-medium text-gray-700">Menores apreendidos</label>
                        <input type="number" id="menores-apreendidos" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group">
                        <label for="pessoas-presas" class="block text-sm font-medium text-gray-700">Pessoas Presas
                            flagrante/TCO</label>
                        <input type="number" id="pessoas-presas" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group">
                        <label for="mandados-prisao" class="block text-sm font-medium text-gray-700">Mandados de
                            Pris√µes cumpridos</label>
                        <input type="number" id="mandados-prisao" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group">
                        <label for="palestras-proerd" class="block text-sm font-medium text-gray-700">Palestras
                            PROERD</label>
                        <input type="number" id="palestras-proerd" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group">
                        <label for="mpu-fiscalizadas" class="block text-sm font-medium text-gray-700">MPU
                            fiscalizadas</label>
                        <input type="number" id="mpu-fiscalizadas" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group">
                        <label for="palestras-transito" class="block text-sm font-medium text-gray-700">Palestras de
                            Tr√¢nsito (Escolas)</label>
                        <input type="number" id="palestras-transito" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group">
                        <label for="palestras-promuse-escolas" class="block text-sm font-medium text-gray-700">Palestras
                            Promuse (Escolas)</label>
                        <input type="number" id="palestras-promuse-escolas" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="form-group col-span-2 sm:col-span-3 md:col-span-2">
                        <label for="palestras-promuse-fabricas"
                            class="block text-sm font-medium text-gray-700">Palestras
                            Promuse/Transito (F√°bricas)</label>
                        <input type="number" id="palestras-promuse-fabricas" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o 3: Textos Livres -->
            <div class="p-4 border border-gray-200 rounded-lg space-y-4">
                <h2 class="text-lg font-semibold text-gray-800 mb-4">Descri√ß√µes</h2>

                <div>
                    <label for="drogas-apreendidas" class="block text-sm font-medium text-gray-700">Drogas
                        apreendidas</label>
                    <textarea id="drogas-apreendidas" rows="3"
                        placeholder="Ex: 100kg de maconha, 2kg de coca√≠na..."
                        class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>

                <div>
                    <label for="outras-apreensoes" class="block text-sm font-medium text-gray-700">Outras
                        apreens√µes</label>
                    <textarea id="outras-apreensoes" rows="3"
                        placeholder="Ex: Contrabando, descaminho, etc..."
                        class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="md:col-span-1">
                        <label for="quantidade-ros" class="block text-sm font-medium text-gray-700">Quantidade de
                            RO's</label>
                        <input type="number" id="quantidade-ros" value="" min="0"
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div class="md:col-span-2">
                        <label for="descricao-ros" class="block text-sm font-medium text-gray-700">Descri√ß√£o/N√∫meros dos
                            RO's</label>
                        <textarea id="descricao-ros" rows="2" placeholder="Ex: RO 123 (Tr√°fico), RO 124 (Vistoria)..."
                            class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"></textarea>
                    </div>
                </div>

                <div>
                    <label for="observacao" class="block text-sm font-medium text-gray-700">Observa√ß√£o (Opcional)</label>
                    <textarea id="observacao" rows="3" placeholder="Alguma informa√ß√£o adicional..."
                        class="mt-1 w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"></textarea>
                </div>

            </div>

            <!-- Se√ß√£o 4: Bot√£o de A√ß√£o -->
            <div class="mt-8 text-center space-y-4">
                <div class="flex flex-col sm:flex-row gap-2 justify-center flex-wrap">
                    <button type="button" id="generate-copy-btn"
                        class="w-full sm:w-auto px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 order-1">
                        Gerar e Copiar
                    </button>
                    <!-- Bot√£o WhatsApp Adicionado -->
                    <button type="button" id="whatsapp-btn"
                        class="w-full sm:w-auto px-6 py-3 bg-green-500 text-white font-semibold rounded-lg shadow-md hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-all duration-200 order-2 flex items-center justify-center gap-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-whatsapp" viewBox="0 0 16 16">
                            <path d="M13.601 2.326A7.854 7.854 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.933 7.933 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.898 7.898 0 0 0 13.6 2.326zM7.994 14.521a6.573 6.573 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.557 6.557 0 0 1 1.928 4.66c-.004 3.626-2.957 6.584-6.591 6.584zm3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.099-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.729.729 0 0 0-.529.247c-.182.198-.691.677-.691 1.654 0 .977.71 1.916.81 2.049.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232z"/>
                        </svg>
                        Enviar
                    </button>
                    <button type="button" id="visualizar-btn"
                        class="w-full sm:w-auto px-6 py-3 bg-gray-600 text-white font-semibold rounded-lg shadow-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all duration-200 order-3">
                        Visualizar
                    </button>
                    <button type="button" id="limpar-btn"
                        class="w-full sm:w-auto px-6 py-3 bg-red-500 text-white font-semibold rounded-lg shadow-md hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition-all duration-200 order-4">
                        Limpar
                    </button>
                </div>
                <p id="copy-feedback" class="text-green-600 font-medium mt-2 h-4"></p>
            </div>
        </form>

        <!-- Se√ß√£o 5: Visualiza√ß√£o (oculta por padr√£o) -->
        <div id="preview-container" class="mt-8 p-4 border border-gray-300 rounded-lg bg-gray-50 hidden">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">Visualiza√ß√£o do Relat√≥rio</h3>
            <pre id="preview-content" class="whitespace-pre-wrap w-full text-sm font-mono bg-white p-4 rounded-md overflow-x-auto"></pre>
        </div>

    </div>

    <script>
        // Vari√°vel global para armazenar o t√≠tulo formatado
        let tituloFormatado = "";

        // Fun√ß√£o para formatar valores (se vazio ou 0, retorna '0', sen√£o retorna o valor)
        function formatValue(value) {
            return value || '0';
        }

        // Fun√ß√£o para formatar texto (se vazio, retorna 'Nada a constar')
        function formatText(text) {
            return text.trim() || 'Nada a constar';
        }

        // Fun√ß√£o para definir o t√≠tulo din√¢mico
        function setDynamicTitle() {
            const hoje = new Date();
            const ontem = new Date(hoje);
            ontem.setDate(hoje.getDate() - 1);

            const diaAnterior = ontem.getDate();
            const diaAtual = hoje.getDate();
            const mes = hoje.getMonth() + 1; // Meses s√£o 0-indexados
            const ano = hoje.getFullYear();

            // Formata para garantir dois d√≠gitos (ex: 01/05/2024)
            const diaAnteriorFmt = String(diaAnterior).padStart(2, '0');
            const diaAtualFmt = String(diaAtual).padStart(2, '0');
            const mesFmt = String(mes).padStart(2, '0');

            tituloFormatado = `Resumo do servi√ßo do dia ${diaAnteriorFmt} para o dia ${diaAtualFmt}/${mesFmt}/${ano}`;
            document.getElementById('titulo-relatorio').textContent = tituloFormatado;
        }

        // Fun√ß√£o para copiar texto para a √°rea de transfer√™ncia
        function copyToClipboard(text, button, feedbackElement) {
            // Cria um textarea tempor√°rio
            const tempTextarea = document.createElement('textarea');
            tempTextarea.value = text;
            tempTextarea.setAttribute('readonly', '');
            tempTextarea.style.position = 'absolute';
            tempTextarea.style.left = '-9999px';
            document.body.appendChild(tempTextarea);

            // Seleciona e copia o texto
            tempTextarea.select();
            try {
                document.execCommand('copy');
                // Feedback visual
                feedbackElement.textContent = 'Relat√≥rio copiado com sucesso!';
                button.textContent = 'Copiado!';
                button.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                button.classList.add('bg-green-600');
            } catch (err) {
                console.error('Falha ao copiar: ', err);
                feedbackElement.textContent = 'Falha ao copiar. Tente manualmente.';
            }

            // Remove o textarea e reverte o bot√£o ap√≥s 2 segundos
            document.body.removeChild(tempTextarea);

            setTimeout(() => {
                feedbackElement.textContent = '';
                button.textContent = 'Gerar Relat√≥rio e Copiar';
                button.classList.remove('bg-green-600');
                button.classList.add('bg-blue-600', 'hover:bg-blue-700');
            }, 2000);
        }

        // Evento principal quando o DOM estiver carregado
        document.addEventListener('DOMContentLoaded', () => {
            setDynamicTitle();

            const generateButton = document.getElementById('generate-copy-btn');
            const feedbackElement = document.getElementById('copy-feedback');
            const form = document.getElementById('report-form');
            
            // Novos bot√µes
            const limparBtn = document.getElementById('limpar-btn');
            const visualizarBtn = document.getElementById('visualizar-btn');
            const previewContainer = document.getElementById('preview-container');
            const previewContent = document.getElementById('preview-content');
            const whatsappBtn = document.getElementById('whatsapp-btn'); // Bot√£o WhatsApp

            // Fun√ß√£o Refatorada para Gerar a String do Relat√≥rio
            function generateReportString() {
                // Valida√ß√£o simples
                const opmRadio = document.querySelector('input[name="opm"]:checked');
                const opm = opmRadio ? opmRadio.value : "";
                
                if (!opm) {
                    feedbackElement.textContent = 'Por favor, selecione a OPM.';
                    feedbackElement.classList.remove('text-green-600');
                    feedbackElement.classList.add('text-red-600');
                    
                    setTimeout(() => {
                         feedbackElement.textContent = '';
                         feedbackElement.classList.remove('text-red-600');
                         feedbackElement.classList.add('text-green-600');
                    }, 2000);
                    return null; // Retorna nulo se inv√°lido
                }

                // Coleta de todos os dados
                const reportData = {
                    opm: opm,
                    viaturas: document.getElementById('viaturas').value,
                    veiculosAbordados: formatValue(document.getElementById('veiculos-abordados').value),
                    pessoasAbordadas: formatValue(document.getElementById('pessoas-abordadas').value),
                    aits: formatValue(document.getElementById('aits').value),
                    sinistros: formatValue(document.getElementById('sinistros').value),
                    veiculosCrime: formatValue(document.getElementById('veiculos-apreendidos-crime').value),
                    veiculosFisc: formatValue(document.getElementById('veiculos-apreendidos-fisc').value),
                    veiculosRecuperados: formatValue(document.getElementById('veiculos-recuperados').value),
                    armas: formatValue(document.getElementById('armas-apreendidas').value),
                    pessoasDpc: formatValue(document.getElementById('pessoas-dpc').value),
                    menores: formatValue(document.getElementById('menores-apreendidos').value),
                    pessoasPresas: formatValue(document.getElementById('pessoas-presas').value),
                    mandados: formatValue(document.getElementById('mandados-prisao').value),
                    proerd: formatValue(document.getElementById('palestras-proerd').value),
                    mpu: formatValue(document.getElementById('mpu-fiscalizadas').value),
                    palestrasTransito: formatValue(document.getElementById('palestras-transito').value),
                    palestrasPromuseEscolas: formatValue(document.getElementById('palestras-promuse-escolas').value),
                    palestrasPromuseFabricas: formatValue(document.getElementById('palestras-promuse-fabricas').value),
                    drogas: formatText(document.getElementById('drogas-apreendidas').value),
                    outrasApreensoes: formatText(document.getElementById('outras-apreensoes').value),
                    qtdRos: formatValue(document.getElementById('quantidade-ros').value),
                    descRos: formatText(document.getElementById('descricao-ros').value),
                    obs: formatText(document.getElementById('observacao').value)
                };

                // --- MODIFICA√á√ÉO DO CABE√áALHO ---
                // Novo cabe√ßalho conforme solicitado
                const newHeader = `*üöîüö® 14¬™ CIPM - ${reportData.opm} üö®üöî*`;

                // Montagem da string de sa√≠da (sem a linha "OPM:" antiga)
                const reportString = `
${newHeader}
${tituloFormatado}
Viaturas Empregadas: ${reportData.viaturas}
---
Ve√≠culos abordados: ${reportData.veiculosAbordados}
Pessoas abordadas: ${reportData.pessoasAbordadas}
AITs: ${reportData.aits}
Sinistros de Tr√¢nsito Atendidos: ${reportData.sinistros}
Ve√≠culos Apreendidos (crime): ${reportData.veiculosCrime}
Ve√≠culos Apreendidos (fiscaliza√ß√£o): ${reportData.veiculosFisc}
Ve√≠culos Recuperados: ${reportData.veiculosRecuperados}
Armas de fogo apreendidas: ${reportData.armas}
Pessoas encaminhadas a DPC: ${reportData.pessoasDpc}
Menores apreendidos: ${reportData.menores}
Pessoas Presas flagrante/TCO: ${reportData.pessoasPresas}
Mandados de Pris√µes cumpridos: ${reportData.mandados}
Palestras PROERD: ${reportData.proerd}
MPU fiscalizadas: ${reportData.mpu}
Palestras de Tr√¢nsito nas Escolas: ${reportData.palestrasTransito}
Palestras Promuse nas Escolas: ${reportData.palestrasPromuseEscolas}
Palestras Promuse/Transito em F√°bricas ou Ind√∫strias: ${reportData.palestrasPromuseFabricas}
---
Drogas apreendidas: ${reportData.drogas}
Outras apreens√µes: ${reportData.outrasApreensoes}
Quantidade de RO's: ${reportData.qtdRos}
Descri√ß√£o/Numeros dos RO's: ${reportData.descRos}
Observa√ß√£o: ${reportData.obs}
`.trim(); // .trim() remove espa√ßos em branco extras no in√≠cio e fim

                return reportString;
            }

            // Evento do Bot√£o Gerar e Copiar
            generateButton.addEventListener('click', () => {
                const reportString = generateReportString();
                if (reportString) {
                    // Copiar para a √°rea de transfer√™ncia
                    copyToClipboard(reportString, generateButton, feedbackElement);
                    // Oculta a visualiza√ß√£o se estiver aberta
                    previewContainer.classList.add('hidden');
                }
            });

            // Evento do Bot√£o Visualizar
            visualizarBtn.addEventListener('click', () => {
                const reportString = generateReportString();
                if (reportString) {
                    previewContent.textContent = reportString;
                    previewContainer.classList.remove('hidden');
                    // Rola para a visualiza√ß√£o
                    previewContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                }
            });

            // Evento do Bot√£o WhatsApp
            whatsappBtn.addEventListener('click', () => {
                const reportString = generateReportString();
                if (reportString) {
                    // Codifica o texto para ser usado em uma URL
                    const encodedText = encodeURIComponent(reportString);
                    // Abre o link do WhatsApp Web/App
                    window.open(`https://api.whatsapp.com/send?text=${encodedText}`, '_blank');
                    
                    // Oculta a visualiza√ß√£o se estiver aberta
                    previewContainer.classList.add('hidden');
                    feedbackElement.textContent = 'Abrindo WhatsApp...';
                    setTimeout(() => {
                         feedbackElement.textContent = '';
                    }, 2000);
                }
            });

            // Evento do Bot√£o Limpar
            limparBtn.addEventListener('click', () => {
                form.reset(); // Reseta todos os campos do formul√°rio
                feedbackElement.textContent = ''; // Limpa mensagens de feedback
                previewContainer.classList.add('hidden'); // Oculta a visualiza√ß√£o
                // Garante que o bot√£o de c√≥pia volte ao normal
                generateButton.textContent = 'Gerar Relat√≥rio e Copiar';
                generateButton.classList.remove('bg-green-600');
                generateButton.classList.add('bg-blue-600', 'hover:bg-blue-700');
            });
        });
    </script>

</body>

</html>


